import 'package:flutter/material.dart';

class LocationFilterBar extends StatefulWidget {
  const LocationFilterBar({super.key});
  @override
  State<LocationFilterBar> createState() => _LocationFilterBarState();
}

class _LocationFilterBarState extends State<LocationFilterBar> {
  String? selectedProvince;
  String? selectedDistrict;
  String? selectedCategory;
  final List<String> provinces = [
    //จังหวัด
    "กรุงเทพมหานคร",
    "กระบี่",
    "กาญจนบุรี",
    "กาฬสินธุ์",
    "กำแพงเพชร",
    "ขอนแก่น",
    "จันทบุรี",
    "ฉะเชิงเทรา",
    "ชลบุรี",
    "ชัยนาท",
    "ชัยภูมิ",
    "ชุมพร",
    "เชียงราย",
    "เชียงใหม่",
    "ตรัง",
    "ตราด",
    "ตาก",
    "นครนายก",
    "นครปฐม",
    "นครพนม",
    "นครราชสีมา",
    "นครศรีธรรมราช",
    "นครสวรรค์",
    "นนทบุรี",
    "นราธิวาส",
    "น่าน",
    "บึงกาฬ",
    "บุรีรัมย์",
    "ปทุมธานี",
    "ประจวบคีรีขันธ์",
    "ปราจีนบุรี",
    "ปัตตานี",
    "พระนครศรีอยุธยา",
    "พะเยา",
    "พังงา",
    "พัทลุง",
    "พิจิตร",
    "พิษณุโลก",
    "เพชรบุรี",
    "เพชรบูรณ์",
    "แพร่",
    "พังงา",
    "ภูเก็ต",
    "มหาสารคาม",
    "มุกดาหาร",
    "แม่ฮ่องสอน",
    "ยโสธร",
    "ยะลา",
    "ร้อยเอ็ด",
    "ระนอง",
    "ระยอง",
    "ราชบุรี",
    "ลพบุรี",
    "ลำปาง",
    "ลำพูน",
    "เลย",
    "ศรีสะเกษ",
    "สกลนคร",
    "สงขลา",
    "สตูล",
    "สมุทรปราการ",
    "สมุทรสงคราม",
    "สมุทรสาคร",
    "สระแก้ว",
    "สระบุรี",
    "สิงห์บุรี",
    "สุโขทัย",
    "สุพรรณบุรี",
    "สุราษฎร์ธานี",
    "สุรินทร์",
    "หนองคาย",
    "หนองบัวลำภู",
    "อ่างทอง",
    "อำนาจเจริญ",
    "อุดรธานี",
    "อุตรดิตถ์",
    "อุทัยธานี",
    "อุบลราชธานี",
  ];
  final Map<String, List<String>> districtsByProvince = {
    //เขต
    'กรุงเทพมหานคร': [
      'เขตพระนคร',
      'เขตดุสิต',
      'เขตหนองจอก',
      'เขตบางรัก',
      'เขตบางเขน',
      'เขตบางกะปิ',
      'เขตปทุมวัน',
      'เขตป้อมปราบศัตรูพ่าย',
      'เขตพระโขนง',
      'เขตมีนบุรี',
      'เขตลาดกระบัง',
      'เขตยานนาวา',
      'เขตสัมพันธวงศ์',
      'เขตพญาไท',
      'เขตธนบุรี',
      'เขตบางกอกใหญ่',
      'เขตห้วยขวาง',
      'เขตคลองสาน',
      'เขตตลิ่งชัน',
      'เขตบางกอกน้อย',
      'เขตบางขุนเทียน',
      'เขตภาษีเจริญ',
      'เขตหนองแขม',
      'เขตราษฎร์บูรณะ',
      'เขตบางพลัด',
      'เขตดินแดง',
      'เขตบึงกุ่ม',
      'เขตสาทร',
      'เขตบางซื่อ',
      'เขตจตุจักร',
      'เขตบางคอแหลม',
      'เขตประเวศ',
      'เขตคลองเตย',
      'เขตสวนหลวง',
      'เขตจอมทอง',
      'เขตดอนเมือง',
      'เขตราชเทวี',
      'เขตลาดพร้าว',
      'เขตวัฒนา',
      'เขตบางแค',
      'เขตหลักสี่',
      'เขตสายไหม',
      'เขตคันนายาว',
      'เขตสะพานสูง',
      'เขตวังทองหลาง',
      'เขตคลองสามวา',
      'เขตบางนา',
      'เขตทวีวัฒนา',
      'เขตทุ่งครุ',
      'เขตบางบอน',
    ],
    'กระบี่': ['เมืองกระบี่', 'อ่าวลึก', 'คลองท่อม'],
    'กาญจนบุรี': [
      'เมืองกาญจนบุรี',
      'ไทรโยค',
      'บ่อพลอย',
      'ป่าไม้อุมง',
      'ศรีสวัสดิ์',
      'ท่ามะกา',
      'ท่าม่วง',
      'ทองผาภูมิ',
      'สังขละบุรี',
      'พนมทวน',
      'เลาขวัญ',
      'ด่านมะขามเตี้ย',
      'หนองปรือ',
      'ห้วยกระเจา',
    ],
    'กาฬสินธุ์': ['เมืองกาฬสินธุ์', 'ยางตลาด', 'กมลาไสย'],
    'กำแพงเพชร': ['เมืองกำแพงเพชร', 'พรานกระต่าย', 'ขาณุวรลักษบุรี'],
    'ขอนแก่น': ['เมืองขอนแก่น', 'บ้านไผ่', 'ชุมแพ'],
    'จันทบุรี': ['เมืองจันทบุรี', 'ท่าใหม่', 'ขลุง'],
    'ฉะเชิงเทรา': ['เมืองฉะเชิงเทรา', 'บางปะกง', 'พนมสารคาม'],
    'ชลบุรี': ['เมืองชลบุรี', 'บางละมุง', 'ศรีราชา'],
    'ชัยนาท': [
      'เมืองชัยนาท',
      'มโนรมย์',
      'วัดสิงห์',
      'สรรพยา',
      'สรรคบุรี',
      'หันคา',
      'หนองมะโมง',
      'เนินขาม',
    ],
    'ชัยภูมิ': ['เมืองชัยภูมิ', 'ภูเขียว', 'เกษตรสมบูรณ์'],
    'ชุมพร': ['เมืองชุมพร', 'หลังสวน', 'ทุ่งตะโก'],
    'เชียงราย': ['เมืองเชียงราย', 'แม่สาย', 'เชียงของ'],
    'เชียงใหม่': ['เมืองเชียงใหม่', 'แม่ริม', 'สันทราย'],
    'ตรัง': ['เมืองตรัง', 'กันตัง', 'ห้วยยอด'],
    'ตราด': ['เมืองตราด', 'คลองใหญ่', 'เกาะช้าง'],
    'ตาก': ['เมืองตาก', 'แม่สอด', 'อุ้มผาง'],
    'นครนายก': ['เมืองนครนายก', 'ปากพลี', 'องครักษ์', 'บ้านนา'],
    'นครปฐม': [
      'เมืองนครปฐม',
      'กำแพงแสน',
      'นครชัยศรี',
      'ดอนตูม',
      'บางเลน',
      'สามพราน',
      'พุทธมณฑล',
    ],
    'นครพนม': ['เมืองนครพนม', 'ท่าอุเทน', 'ธาตุพนม'],
    'นครราชสีมา': ['เมืองนครราชสีมา', 'ปากช่อง', 'พิมาย'],
    'นครศรีธรรมราช': ['เมืองนครศรีธรรมราช', 'ทุ่งสง', 'ปากพนัง'],
    'นครสวรรค์': ['เมืองนครสวรรค์', 'ตาคลี', 'พยุหะคีรี'],
    'นนทบุรี': ['เมืองนนทบุรี', 'ปากเกร็ด', 'บางบัวทอง'],
    'นราธิวาส': ['เมืองนราธิวาส', 'สุไหงโก-ลก', 'ตากใบ'],
    'น่าน': ['เมืองน่าน', 'ปัว', 'ท่าวังผา'],
    'บึงกาฬ': ['เมืองบึงกาฬ', 'ปากคาด', 'พรเจริญ'],
    'บุรีรัมย์': ['เมืองบุรีรัมย์', 'พุทไธสง', 'ประโคนชัย'],
    'ปทุมธานี': ['เมืองปทุมธานี', 'ธัญบุรี', 'คลองหลวง'],
    'ประจวบคีรีขันธ์': ['เมืองประจวบคีรีขันธ์', 'หัวหิน', 'ปราณบุรี'],
    'ปราจีนบุรี': ['เมืองปราจีนบุรี', 'กบินทร์บุรี', 'ศรีมหาโพธิ'],
    'ปัตตานี': ['เมืองปัตตานี', 'โคกโพธิ์', 'ยะหริ่ง'],
    'พระนครศรีอยุธยา': ['พระนครศรีอยุธยา', 'บางปะอิน', 'วังน้อย'],
    'พะเยา': ['เมืองพะเยา', 'เชียงคำ', 'ดอกคำใต้'],
    'พังงา': ['เมืองพังงา', 'ตะกั่วป่า', 'คุระบุรี'],
    'พัทลุง': ['เมืองพัทลุง', 'ควนขนุน', 'ปากพะยูน'],
    'พิจิตร': ['เมืองพิจิตร', 'ตะพานหิน', 'บางมูลนาก'],
    'พิษณุโลก': ['เมืองพิษณุโลก', 'วังทอง', 'บางระกำ'],
    'เพชรบุรี': ['เมืองเพชรบุรี', 'ชะอำ', 'ท่ายาง'],
    'เพชรบูรณ์': ['เมืองเพชรบูรณ์', 'หล่มสัก', 'เขาค้อ'],
    'แพร่': ['เมืองแพร่', 'สูงเม่น', 'ลอง'],
    'ภูเก็ต': ['เมืองภูเก็ต', 'กะทู้', 'ถลาง'],
    'มหาสารคาม': ['เมืองมหาสารคาม', 'บรบือ', 'โกสุมพิสัย'],
    'มุกดาหาร': ['เมืองมุกดาหาร', 'คำชะอี', 'ดอนตาล'],
    'แม่ฮ่องสอน': ['เมืองแม่ฮ่องสอน', 'ปาย', 'แม่สะเรียง'],
    'ยโสธร': ['เมืองยโสธร', 'คำเขื่อนแก้ว', 'เลิงนกทา'],
    'ยะลา': ['เมืองยะลา', 'เบตง', 'รามัน'],
    'ร้อยเอ็ด': ['เมืองร้อยเอ็ด', 'ธวัชบุรี', 'สุวรรณภูมิ'],
    'ระนอง': ['เมืองระนอง', 'กระบุรี', 'กะเปอร์'],
    'ระยอง': ['เมืองระยอง', 'บ้านฉาง', 'ปลวกแดง'],
    'ราชบุรี': ['เมืองราชบุรี', 'โพธาราม', 'บ้านโป่ง'],
    'ลพบุรี': ['เมืองลพบุรี', 'บ้านหมี่', 'โคกสำโรง'],
    'ลำปาง': ['เมืองลำปาง', 'เกาะคา', 'เถิน'],
    'ลำพูน': ['เมืองลำพูน', 'ป่าซาง', 'บ้านโฮ่ง'],
    'เลย': ['เมืองเลย', 'เชียงคาน', 'วังสะพุง'],
    'ศรีสะเกษ': ['เมืองศรีสะเกษ', 'กันทรลักษ์', 'ขุขันธ์'],
    'สกลนคร': ['เมืองสกลนคร', 'สว่างแดนดิน', 'พรรณานิคม'],
    'สงขลา': ['เมืองสงขลา', 'หาดใหญ่', 'สะเดา'],
    'สตูล': ['เมืองสตูล', 'ละงู', 'ควนกาหลง'],
    'สมุทรปราการ': ['เมืองสมุทรปราการ', 'บางพลี', 'พระประแดง'],
    'สมุทรสงคราม': ['เมืองสมุทรสงคราม', 'อัมพวา', 'บางคนที'],
    'สมุทรสาคร': ['เมืองสมุทรสาคร', 'กระทุ่มแบน', 'บ้านแพ้ว'],
    'สระแก้ว': ['เมืองสระแก้ว', 'อรัญประเทศ', 'วัฒนานคร'],
    'สระบุรี': ['เมืองสระบุรี', 'แก่งคอย', 'มวกเหล็ก'],
    'สิงห์บุรี': ['เมืองสิงห์บุรี', 'บางระจัน', 'พรหมบุรี'],
    'สุโขทัย': ['เมืองสุโขทัย', 'สวรรคโลก', 'ศรีสำโรง'],
    'สุพรรณบุรี': ['เมืองสุพรรณบุรี', 'สองพี่น้อง', 'อู่ทอง'],
    'สุราษฎร์ธานี': ['เมืองสุราษฎร์ธานี', 'เกาะสมุย', 'กาญจนดิษฐ์'],
    'สุรินทร์': ['เมืองสุรินทร์', 'ท่าตูม', 'จอมพระ'],
    'หนองคาย': ['เมืองหนองคาย', 'ท่าบ่อ', 'โพนพิสัย'],
    'หนองบัวลำภู': ['เมืองหนองบัวลำภู', 'นากลาง', 'สุวรรณคูหา'],
    'อ่างทอง': ['เมืองอ่างทอง', 'วิเศษชัยชาญ', 'ป่าโมกข์'],
    'อำนาจเจริญ': ['เมืองอำนาจเจริญ', 'ชานุมาน', 'ปทุมราชวงศา'],
    'อุดรธานี': ['เมืองอุดรธานี', 'กุมภวาปี', 'หนองหาน'],
    'อุตรดิตถ์': ['เมืองอุตรดิตถ์', 'ลับแล', 'พิชัย'],
    'อุทัยธานี': ['เมืองอุทัยธานี', 'ทัพทัน', 'บ้านไร่'],
    'อุบลราชธานี': ['เมืองอุบลราชธานี', 'วารินชำราบ', 'เดชอุดม'],
  };
  final List<String> foodTypes = [
    //ประเภทอาหาร
    "อาหารไทย",
    "อาหารตามสั่ง",
    "อาหารอีสาน",
    "อาหารญี่ปุ่น",
    "อาหารเกาหลี",
    "อาหารจีน",
    "อาหารยุโรป",
    "อาหารอิตาเลียน",
    "อาหารอินเดีย",
    "อาหารเจ/มังสวิรัติ",
    "อาหารทะเล",
    "คาเฟ่/ของหวาน",
    "ของทานเล่น/ขนม",
    "อื่นๆ",
  ];
  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.all(8.0),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          SingleChildScrollView(
            scrollDirection: Axis.horizontal,
            child: Row(
              children: [
                _buildProvinceDropdown(),
                const SizedBox(width: 8),
                _buildDistrictDropdown(),
                const SizedBox(width: 8),
                _buildLocationButton(),
              ],
            ),
          ),
          const SizedBox(height: 8),
          SizedBox(width: double.infinity, child: _buildCategoryDropdown()),
        ],
      ),
    );
  }

  Widget _buildProvinceDropdown() {
    return _buildContainer(
      SizedBox(
        width: 130,
        child: DropdownButton<String>(
          isExpanded: true,
          value: selectedProvince,
          hint: const Text(
            'กรุณาเลือกจังหวัด',
            style: TextStyle(color: Colors.white),
          ),
          dropdownColor: Colors.pink[200],
          style: const TextStyle(color: Colors.white),
          items: provinces.map((String value) {
            return DropdownMenuItem<String>(
              value: value,
              child: Text(value, style: const TextStyle(color: Colors.white)),
            );
          }).toList(),
          onChanged: (newValue) {
            setState(() {
              selectedProvince = newValue;
              selectedDistrict = null;
            });
          },
        ),
      ),
    );
  }

  Widget _buildDistrictDropdown() {
    final districts = districtsByProvince[selectedProvince] ?? [];
    return _buildContainer(
      SizedBox(
        width: 175,
        child: DropdownButton<String>(
          isExpanded: true,
          value: selectedDistrict,
          hint: const Text(
            'กรุณาเลือกเขตหรืออำเภอ',
            style: TextStyle(color: Colors.white),
          ),
          dropdownColor: Colors.pink[200],
          style: const TextStyle(color: Colors.white),
          items: districts.map((String value) {
            return DropdownMenuItem<String>(
              value: value,
              child: Text(value, style: const TextStyle(color: Colors.white)),
            );
          }).toList(),
          onChanged: (newValue) {
            setState(() {
              selectedDistrict = newValue;
            });
          },
        ),
      ),
    );
  }

  Widget _buildCategoryDropdown() {
    return Container(
      height: 35,
      padding: const EdgeInsets.symmetric(horizontal: 12),
      decoration: BoxDecoration(
        color: Colors.pink[300],
        borderRadius: BorderRadius.circular(20),
      ),
      child: DropdownButton<String>(
        isExpanded: true,
        value: selectedCategory,
        hint: const Text(
          'ตัวกรองประเภทอาหาร',
          style: TextStyle(color: Colors.white),
        ),
        dropdownColor: Colors.pink[200],
        style: const TextStyle(color: Colors.white),
        iconEnabledColor: Colors.white,
        items: foodTypes.map((String value) {
          return DropdownMenuItem<String>(
            value: value,
            child: Text(value, style: const TextStyle(color: Colors.white)),
          );
        }).toList(),
        onChanged: (newValue) {
          setState(() {
            selectedCategory = newValue;
          });
        },
      ),
    );
  }

  Widget _buildLocationButton() {
    return _buildContainer(
      SizedBox(
        width: 150,
        child: TextButton.icon(
          onPressed: () {
            // TODO: ดึงตำแหน่งปัจจุบัน
          },
          icon: const Icon(Icons.my_location, color: Colors.white),
          label: const Text(
            "ตำแหน่งปัจจุบัน",
            style: TextStyle(color: Colors.white),
          ),
        ),
      ),
    );
  }

  Widget _buildContainer(Widget child) {
    return Container(
      height: 35,
      padding: EdgeInsets.symmetric(horizontal: 12),
      decoration: BoxDecoration(
        color: Colors.pink[300],
        borderRadius: BorderRadius.circular(20),
      ),
      child: child,
    );
  }
}
